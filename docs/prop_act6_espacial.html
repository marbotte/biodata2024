<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="es_CL" xml:lang="es_CL">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Talleres Biodata 2024: Datos espaciales: propuesta de solución</title>

  <meta property="description" itemprop="description" content="Manejar datos espaciales en R y SQL"/>



  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Talleres Biodata 2024: Datos espaciales: propuesta de solución"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Manejar datos espaciales en R y SQL"/>
  <meta property="og:locale" content="es_CL"/>
  <meta property="og:site_name" content="Talleres Biodata 2024"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Talleres Biodata 2024: Datos espaciales: propuesta de solución"/>
  <meta property="twitter:description" content="Manejar datos espaciales en R y SQL"/>

  <!--/radix_placeholder_meta_tags-->
  
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","lang","description","output","bibliography"]}},"value":[{"type":"character","attributes":{},"value":["Datos espaciales: propuesta de solución"]},{"type":"character","attributes":{},"value":["es_CL"]},{"type":"character","attributes":{},"value":["Manejar datos espaciales en R y SQL"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_float","fig_caption","pandoc_args"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["--number-sections"]}]}]},{"type":"character","attributes":{},"value":["./biodata2024.bib"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Datos espaciales: propuesta de solución","description":"Manejar datos espaciales en R y SQL","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Talleres Biodata 2024</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Antes de empezar
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="doc_config.html">Connexión, configuración y uso de software</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
R y SQL
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://docs.google.com/presentation/d/1q0X60VRCAIJG-NjIKe1hPIw2uxlk_w1_/edit?usp=sharing&amp;ouid=116883851522713757892&amp;rtpof=true&amp;sd=true">Introducción: Marius Bottin y Instituto Humboldt</a>
<hr/>
<span class="nav-dropdown-header">Actividad</span>
<hr/>
<a href="https://docs.google.com/presentation/d/18plX_FYs_ZnBU39r26qxVQkoRkw0cNedyKuEcXFhhGE/edit?usp=sharing">Introducción</a>
<a href="act_1_1_SQL.html">Actividad 1.1: SQL</a>
<a href="prop_act_1_1_SQL.html">Propuesta de solución actividad 1.1</a>
<a href="act_1_2_R.html">Actividad 1.2: R</a>
<a href="prop_act_1_2_R.html">Propuesta de solución actividad 1.2</a>
<hr/>
<span class="nav-dropdown-header">Documentación SQL</span>
<hr/>
<a href="doc_SQL_simple.html">Consultas simples</a>
<a href="doc_SQL_consultas_avanzadas.html">Consultas tablas múltiples</a>
<hr/>
<span class="nav-dropdown-header">Documentación R</span>
<hr/>
<a href="doc_R_clases_modos.html">Modos y clases</a>
<a href="doc_R_import_export.html">Importar y exportar datos</a>
<a href="doc_R_buscarRelacionar.html">Buscar datos y relacionar objetos</a>
<a href="doc_R_structuraControl.html">Bucles, funciones y estructuras de control</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Estándares
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://docs.google.com/presentation/d/1fMp8PnBGWLQrFQEBt1VFVJAJGTdCViTSpWEcO8xd8BQ/edit?usp=drive_link">Introducción</a>
<a href="act_2_estandares.html">Actividad: Explorar Darwin Core y Ecological Metadata Language</a>
<a href="prop_act_2_estandares.html">propuesta de solucion actividad 2</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Taxonomía
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="act_5_taxonomia.html">Actividad: manejar la taxonomía en los datos de biodiversidad</a>
<a href="prop_act5_taxo.html">Propuesta de solución para los ejercicios de taxonomía</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Datos espaciales
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="act_6_espacial.html">Actividad: datos espaciales</a>
<a href="prop_act6_espacial.html">Propuesta de solución para los ejercicios de datos espaciales</a>
</div>
</div>
</div>
<div class="nav-right">
<div class="nav-dropdown">
<button class="nav-dropbtn">
Instalación de software
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="inst_gen.html">Generalidades</a>
<a href="inst_R.html">R y RStudio</a>
<a href="inst_SQL.html">SQL</a>
<a href="inst_espac.html">Software para datos espaciales</a>
</div>
</div>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Datos espaciales: propuesta de solución</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p>Manejar datos espaciales en R y SQL</p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#ejercicio-1-representar-los-grupos-biologicos-en-qgis" id="toc-ejercicio-1-representar-los-grupos-biologicos-en-qgis"><span class="toc-section-number">1</span> Ejercicio 1: Representar los grupos biologicos en QGIS</a></li>
<li><a href="#ejercicio-2-buscar-las-comunas-chilenas-en-un-archivo-darwin-core" id="toc-ejercicio-2-buscar-las-comunas-chilenas-en-un-archivo-darwin-core"><span class="toc-section-number">2</span> Ejercicio 2: buscar las comunas chilenas en un archivo Darwin Core</a>
<ul>
<li><a href="#cargar-los-paquetes" id="toc-cargar-los-paquetes"><span class="toc-section-number">2.1</span> Cargar los paquetes</a></li>
<li><a href="#extraer-el-archivo-de-occurrencia" id="toc-extraer-el-archivo-de-occurrencia"><span class="toc-section-number">2.2</span> Extraer el archivo de occurrencia</a></li>
<li><a href="#extraer-el-shapefile-de-comunas-de-chile" id="toc-extraer-el-shapefile-de-comunas-de-chile"><span class="toc-section-number">2.3</span> Extraer el shapefile de comunas de Chile</a></li>
<li><a href="#leer-el-archivo-de-occurrencia-y-espacializarlo" id="toc-leer-el-archivo-de-occurrencia-y-espacializarlo"><span class="toc-section-number">2.4</span> Leer el archivo de occurrencia y “espacializarlo”</a></li>
<li><a href="#leer-el-shapefile-de-comunas" id="toc-leer-el-shapefile-de-comunas"><span class="toc-section-number">2.5</span> Leer el shapefile de comunas</a></li>
<li><a href="#buscar-las-comunas" id="toc-buscar-las-comunas"><span class="toc-section-number">2.6</span> Buscar las comunas</a></li>
<li><a href="#bonus-mapas-en-r" id="toc-bonus-mapas-en-r"><span class="toc-section-number">2.7</span> Bonus: mapas en R</a></li>
</ul></li>
<li><a href="#ejercicio-3-crear-una-base-de-datos-espacial-para-determinar-los-habitats-de-muestreo" id="toc-ejercicio-3-crear-una-base-de-datos-espacial-para-determinar-los-habitats-de-muestreo"><span class="toc-section-number">3</span> Ejercicio 3: crear una base de datos espacial para determinar los habitats de muestreo</a>
<ul>
<li><a href="#con-spatialite" id="toc-con-spatialite"><span class="toc-section-number">3.1</span> Con spatialite</a></li>
<li><a href="#con-postgis" id="toc-con-postgis"><span class="toc-section-number">3.2</span> Con Postgis</a></li>
</ul></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h1 data-number="1" id="ejercicio-1-representar-los-grupos-biologicos-en-qgis"><span class="header-section-number">1</span> Ejercicio 1: Representar los grupos biologicos en QGIS</h1>
<p>Conectar Qgis a la base de datos (ver <a href="https://mappinggis.com/2023/01/como-conectar-qgis-a-postgis/" class="uri">https://mappinggis.com/2023/01/como-conectar-qgis-a-postgis/</a>).</p>
<p>Abrir la consola en Qgis:</p>
<p>“Base de datos” &gt; “DB Manager” &gt; Abrir la base de datos en el panel de la Izquierda &gt; <img src="Figs/consoleSQL_Qgis.png" style="width:5.0%" /></p>
<p>Entrar el código siguiente:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> cd_event, cd_gp_biol, pt_geom</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> main.event e</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> main.gp_event ge <span class="kw">USING</span> (cd_gp_event);</span></code></pre></div>
<p>“Ejecutar”</p>
<p>“Cargar como una nueva capa” &gt; “Columna con valores unicos”: cd_event &gt; “Columna de geometría”: pt_geom &gt; “Cargar”</p>
<p>En Qgis, ir a la nueva capa que proviene de Qgis y hacer un click derecho &gt; “Propiedades” &gt; “Simbología”</p>
<p>Cambiar “Simbolos unicos” por “Categorizado”</p>
<p>En valores: cd_gp_biol</p>
<p>Hacer click en “Clasificar” y “OK”</p>
<h1 data-number="2" id="ejercicio-2-buscar-las-comunas-chilenas-en-un-archivo-darwin-core"><span class="header-section-number">2</span> Ejercicio 2: buscar las comunas chilenas en un archivo Darwin Core</h1>
<h2 data-number="2.1" id="cargar-los-paquetes"><span class="header-section-number">2.1</span> Cargar los paquetes</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/sf/'>sf</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mablab.org/rpostgis/'>rpostgis</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 data-number="2.2" id="extraer-el-archivo-de-occurrencia"><span class="header-section-number">2.2</span> Extraer el archivo de occurrencia</h2>
<p>Utilizamos una carpeta temporaria para extraer las occurrencias desde el archivo comprimido (ver <a href="prop_act_2_estandares.html">actividad de estándares</a>)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.exists</a></span><span class='op'>(</span><span class='st'>"../Datos/tmp"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>{</span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='st'>"../Datos/tmp"</span><span class='op'>)</span><span class='op'>}</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/unzip.html'>unzip</a></span><span class='op'>(</span><span class='st'>"../Datos/dwca-fotomonitoreo_conaf_2021-v1.9.zip"</span>,files <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"occurrence.txt"</span><span class='op'>)</span>, exdir <span class='op'>=</span> <span class='st'>"../Datos/tmp"</span>, overwrite <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 data-number="2.3" id="extraer-el-shapefile-de-comunas-de-chile"><span class="header-section-number">2.3</span> Extraer el shapefile de comunas de Chile</h2>
<p>El shapefile de las comunas está también en un archivo comprimido, extraemos todos los archivos en la carpeta temporaria</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/unzip.html'>unzip</a></span><span class='op'>(</span><span class='st'>"../Datos/Comunas.zip"</span>,exdir <span class='op'>=</span> <span class='st'>"../Datos/tmp/"</span>,overwrite <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 data-number="2.4" id="leer-el-archivo-de-occurrencia-y-espacializarlo"><span class="header-section-number">2.4</span> Leer el archivo de occurrencia y “espacializarlo”</h2>
<p>Cargar el archivo de occurrencia en R:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>occuFotoTrampeo</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"../Datos/tmp/occurrence.txt"</span>,sep<span class='op'>=</span><span class='st'>"\t"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Para este ejercicio, vamos a utilizar solo 50 filas aleatorias del archivo (¡son procesos pesados, con 50 filas es más rapido!).
Pero no duden en suprimir esta fila si quieren aplicar el tratamiento al archivo entero en sus computadores!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>occuFotoTrampeo</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 612187     57</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>occuFotoTrampeo</span><span class='op'>&lt;-</span><span class='va'>occuFotoTrampeo</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>occuFotoTrampeo</span><span class='op'>)</span>,<span class='fl'>50</span><span class='op'>)</span>,<span class='op'>]</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>occuFotoTrampeo</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 50 57</code></pre>
</div>
<p>Para explicar el principio del codigo previo:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>occuFotoTrampeo</span><span class='op'>)</span>,<span class='fl'>50</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code> [1] 42 45 20 43  2 12 27 15 14  6 46 16 19 22 25  1  3 44 34 49 41 35
[23]  9 18 38 40 17 31 29 48 23 11 50 13 36  5 32 39 47 30 24  7 21 10
[45] 33 26  4 28 37  8</code></pre>
</div>
<p>En R, utilizamos una clase particular de objetos, definida en el paquete <code>sf</code>, para manejar los atributos espaciales.
La función <code>st_as_sf</code> permite definir cuales son las columnas de una tabla que contienen las coordenadas de puntos, y así transformar la tabla en un objeto espacial.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>spat_occuFotoTrampeo</span><span class='op'>&lt;-</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_as_sf.html'>st_as_sf</a></span><span class='op'>(</span><span class='va'>occuFotoTrampeo</span>,coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"decimalLongitude"</span>,<span class='st'>"decimalLatitude"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Afectamos el sistema de proyección WGS84, gracias al SRID (Spatial Reference IDentifier).
Pueden utilizar el sitio web <a href="https://epsg.io/" class="uri">https://epsg.io/</a> para encontrar los sistemas de referencia y sus identificadores.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_crs.html'>st_crs</a></span><span class='op'>(</span><span class='va'>spat_occuFotoTrampeo</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='st'>"EPSG:4326"</span></span></code></pre>
</div>
</div>
<h2 data-number="2.5" id="leer-el-shapefile-de-comunas"><span class="header-section-number">2.5</span> Leer el shapefile de comunas</h2>
<p>Siendo un shapefile, el archivo se lee directamente como un archivo espacial, gracias a la función <code>st_read</code>.
La función utiliza la noción de “dsn” que es el objeto que contiene las capas (acá la carpeta que contiene el shapefile, pero puede ser una base de datos espacial, una geodatabase de ESRI etc.), y los “layers” que son cada una de las capas:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>comunas</span><span class='op'>&lt;-</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_read.html'>st_read</a></span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"../Datos/tmp/"</span>,layer<span class='op'>=</span><span class='st'>"comunas"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Reading layer `comunas&#39; from data source 
  `/home/marius/Travail/Enseignement/2023_cursoBiodiversidadChile/2024/Datos/tmp&#39; 
  using driver `ESRI Shapefile&#39;
Simple feature collection with 346 features and 11 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -12184470 ymin: -7554436 xmax: -7393642 ymax: -1978920
Projected CRS: WGS 84 / Pseudo-Mercator</code></pre>
</div>
<p>Para poder hacer un tratamiento espacial con las occurrencias y las comunas, tenemos que asegurarnos que los objetos están en el mismo sistema de proyección:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>spat_occuFotoTrampeo</span><span class='op'>&lt;-</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_transform.html'>st_transform</a></span><span class='op'>(</span><span class='va'>spat_occuFotoTrampeo</span>,<span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_crs.html'>st_crs</a></span><span class='op'>(</span><span class='va'>comunas</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 data-number="2.6" id="buscar-las-comunas"><span class="header-section-number">2.6</span> Buscar las comunas</h2>
<p>Mirar la estructura de los objetos espaciales</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>spat_occuFotoTrampeo</span></span></code></pre>
</div>
<pre><code>Simple feature collection with 50 features and 55 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -8787969 ymin: -7022447 xmax: -7830540 ymax: -3985424
Projected CRS: WGS 84 / Pseudo-Mercator
First 10 features:
                                              id        type
413245   CONAF:Fotomonitoreo:PNVPR:2022:AN45:632 Fototrampeo
250955 CONAF:Fotomonitoreo:RNMAG:2022:CP18:16187 Fototrampeo
536725   CONAF:Fotomonitoreo:PNP:2019:BB28:10814 Fototrampeo
393015    CONAF:Fotomonitoreo:PNCH:2021:M01:8073 Fototrampeo
564579   CONAF:Fotomonitoreo:PNCC:2022:H23:11493 Fototrampeo
591758     CONAF:Fotomonitoreo:PNRCL:2018:B7:395 Fototrampeo
534315   CONAF:Fotomonitoreo:PNP:2019:BT19:25590 Fototrampeo
375249     CONAF:Fotomonitoreo:RNM:2021:F07:3241 Fototrampeo
506322    CONAF:Fotomonitoreo:RNM:2021:O26:11251 Fototrampeo
107656    CONAF:Fotomonitoreo:RNRC:2017:I08:1332 Fototrampeo
         modified language
413245 2023-12-06       es
250955 2023-12-06       es
536725 2023-12-06       es
393015 2023-12-06       es
564579 2023-12-06       es
591758 2023-12-06       es
534315 2023-12-06       es
375249 2023-12-06       es
506322 2023-12-06       es
107656 2023-12-06       es
                                                        license
413245 https://creativecommons.org/licenses/by-nc/4.0/legalcode
250955 https://creativecommons.org/licenses/by-nc/4.0/legalcode
536725 https://creativecommons.org/licenses/by-nc/4.0/legalcode
393015 https://creativecommons.org/licenses/by-nc/4.0/legalcode
564579 https://creativecommons.org/licenses/by-nc/4.0/legalcode
591758 https://creativecommons.org/licenses/by-nc/4.0/legalcode
534315 https://creativecommons.org/licenses/by-nc/4.0/legalcode
375249 https://creativecommons.org/licenses/by-nc/4.0/legalcode
506322 https://creativecommons.org/licenses/by-nc/4.0/legalcode
107656 https://creativecommons.org/licenses/by-nc/4.0/legalcode
                                                rightsHolder
413245                 Corporación Nacional Forestal (CONAF)
250955 Centro de Ecología Aplicada y Sustentabilidad (CAPES)
536725                 Corporación Nacional Forestal (CONAF)
393015                 Corporación Nacional Forestal (CONAF)
564579                 Corporación Nacional Forestal (CONAF)
591758                 Corporación Nacional Forestal (CONAF)
534315                 Corporación Nacional Forestal (CONAF)
375249                 Corporación Nacional Forestal (CONAF)
506322                 Corporación Nacional Forestal (CONAF)
107656                 Corporación Nacional Forestal (CONAF)
                                                                                                                                                                                                                                    bibliographicCitation
413245 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
250955 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
536725 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
393015 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
564579 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
591758 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
534315 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
375249 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
506322 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
107656 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
       institutionID        collectionID
413245         CONAF CONAF:Fotomonitoreo
250955         CONAF CONAF:Fotomonitoreo
536725         CONAF CONAF:Fotomonitoreo
393015         CONAF CONAF:Fotomonitoreo
564579         CONAF CONAF:Fotomonitoreo
591758         CONAF CONAF:Fotomonitoreo
534315         CONAF CONAF:Fotomonitoreo
375249         CONAF CONAF:Fotomonitoreo
506322         CONAF CONAF:Fotomonitoreo
107656         CONAF CONAF:Fotomonitoreo
                             institutionCode collectionCode
413245 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
250955 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
536725 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
393015 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
564579 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
591758 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
534315 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
375249 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
506322 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
107656 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
       ownerInstitutionCode      basisOfRecord
413245                CONAF MachineObservation
250955                CONAF MachineObservation
536725                CONAF MachineObservation
393015                CONAF MachineObservation
564579                CONAF MachineObservation
591758                CONAF MachineObservation
534315                CONAF MachineObservation
375249                CONAF MachineObservation
506322                CONAF MachineObservation
107656                CONAF MachineObservation
                                    occurrenceID individualCount
413245   CONAF:Fotomonitoreo:PNVPR:2022:AN45:632               1
250955 CONAF:Fotomonitoreo:RNMAG:2022:CP18:16187               1
536725   CONAF:Fotomonitoreo:PNP:2019:BB28:10814               4
393015    CONAF:Fotomonitoreo:PNCH:2021:M01:8073               1
564579   CONAF:Fotomonitoreo:PNCC:2022:H23:11493               2
591758     CONAF:Fotomonitoreo:PNRCL:2018:B7:395               1
534315   CONAF:Fotomonitoreo:PNP:2019:BT19:25590               1
375249     CONAF:Fotomonitoreo:RNM:2021:F07:3241               1
506322    CONAF:Fotomonitoreo:RNM:2021:O26:11251               1
107656    CONAF:Fotomonitoreo:RNRC:2017:I08:1332               1
                 sex     lifeStage reproductiveCondition
413245 Indeterminado Indeterminado         Indeterminado
250955 Indeterminado Indeterminado         Indeterminado
536725 Indeterminado Indeterminado         Indeterminado
393015 Indeterminado Indeterminado         Indeterminado
564579 Indeterminado Indeterminado         Indeterminado
591758 Indeterminado Indeterminado         Indeterminado
534315 Indeterminado Indeterminado         Indeterminado
375249 Indeterminado Indeterminado         Indeterminado
506322 Indeterminado Indeterminado         Indeterminado
107656 Indeterminado Indeterminado         Indeterminado
       establishmentMeans degreeOfEstablishment occurrenceStatus
413245             native                native          present
250955         introduced    widespreadInvasive          present
536725         introduced    widespreadInvasive          present
393015             native                native          present
564579         introduced    widespreadInvasive          present
591758             native                native          present
534315         introduced    widespreadInvasive          present
375249         introduced    widespreadInvasive          present
506322         introduced    widespreadInvasive          present
107656         introduced    widespreadInvasive          present
       occurrenceRemarks                             eventID
413245                   CONAF:Fotomonitoreo:PNVPR:2022:AN45
250955                   CONAF:Fotomonitoreo:RNMAG:2022:CP18
536725                     CONAF:Fotomonitoreo:PNP:2019:BB28
393015                     CONAF:Fotomonitoreo:PNCH:2021:M01
564579                     CONAF:Fotomonitoreo:PNCC:2022:H23
591758                     CONAF:Fotomonitoreo:PNRCL:2018:B7
534315                     CONAF:Fotomonitoreo:PNP:2019:BT19
375249                      CONAF:Fotomonitoreo:RNM:2021:F07
506322                      CONAF:Fotomonitoreo:RNM:2021:O26
107656                     CONAF:Fotomonitoreo:RNRC:2017:I08
        eventDate   eventTime startDayOfYear endDayOfYear year month
413245 2022-01-21 22:01:34-04            300           33 2022     1
250955 2022-03-28 04:53:28-04             85          319 2022     3
536725 2019-02-27 21:05:07-04             39          143 2019     2
393015 2021-03-27 12:38:05-04             62           96 2021     3
564579 2022-01-19 06:59:16-04             12           43 2022     1
591758 2018-05-02 04:28:57-04            114          144 2018     5
534315 2019-07-27 23:55:51-04             37          225 2019     7
375249 2020-12-18 19:55:36-04            346           11 2020    12
506322 2021-02-17 08:56:02-04             36           68 2021     2
107656 2017-08-12 16:22:16-04            144          265 2017     8
       day locationID     continent country countryCode
413245  21      PNVPR South America   Chile          CL
250955  28      RNMAG South America   Chile          CL
536725  27        PNP South America   Chile          CL
393015  27       PNCH South America   Chile          CL
564579  19       PNCC South America   Chile          CL
591758   2      PNRCL South America   Chile          CL
534315  27        PNP South America   Chile          CL
375249  18        RNM South America   Chile          CL
506322  17        RNM South America   Chile          CL
107656  12       RNRC South America   Chile          CL
                                             stateProvince
413245                                 Región de Los Lagos
250955      Región de Magallanes y de la Antártica Chilena
536725 Región de Aysén del General Carlos Ibáñez del Campo
393015                                 Región de Los Lagos
564579 Región de Aysén del General Carlos Ibáñez del Campo
591758                    Región Metropolitana de Santiago
534315 Región de Aysén del General Carlos Ibáñez del Campo
375249                              Región de La Araucanía
506322                              Región de La Araucanía
107656    Región del Libertador General Bernardo O&#39;Higgins
                                    locality geodeticDatum
413245 Parque Nacional Vicente Pérez Rosales     EPSG:4326
250955           Reserva Nacional Magallanes     EPSG:4326
536725             Parque Nacional Patagonia     EPSG:4326
393015                Parque Nacional Chiloé     EPSG:4326
564579        Parque Nacional Cerro Castillo     EPSG:4326
591758          Parque Nacional Rio Clarillo     EPSG:4326
534315             Parque Nacional Patagonia     EPSG:4326
375249        Reserva Nacional Malalcahuello     EPSG:4326
506322        Reserva Nacional Malalcahuello     EPSG:4326
107656  Reserva Nacional Rio de los Cipreses     EPSG:4326
       coordinateUncertaintyInMeters verbatimCoordinateSystem
413245                          1000          decimal degrees
250955                          1000          decimal degrees
536725                          1000          decimal degrees
393015                          1000          decimal degrees
564579                          1000          decimal degrees
591758                          1000          decimal degrees
534315                          1000          decimal degrees
375249                          1000          decimal degrees
506322                          1000          decimal degrees
107656                          1000          decimal degrees
       verbatimSRS                        scientificName
413245      WGS 84     Dromiciops gliroides Thomas, 1894
250955      WGS 84 Canis lupus familiaris Linnaeus, 1758
536725      WGS 84             Bos taurus Linnaeus, 1758
393015      WGS 84              Pudu puda (Molina, 1782)
564579      WGS 84             Bos taurus Linnaeus, 1758
591758      WGS 84     Lycalopex culpaeus (Molina, 1782)
534315      WGS 84         Equus caballus Linnaeus, 1758
375249      WGS 84             Bos taurus Linnaeus, 1758
506322      WGS 84             Bos taurus Linnaeus, 1758
107656      WGS 84             Bos taurus Linnaeus, 1758
            originalNameUsage  kingdom   phylum    class
413245   Dromiciops gliroides Animalia Chordata Mammalia
250955 Canis lupus familiaris Animalia Chordata Mammalia
536725             Bos taurus Animalia Chordata Mammalia
393015              Pudu puda Animalia Chordata Mammalia
564579             Bos taurus Animalia Chordata Mammalia
591758     Lycalopex culpaeus Animalia Chordata Mammalia
534315         Equus caballus Animalia Chordata Mammalia
375249             Bos taurus Animalia Chordata Mammalia
506322             Bos taurus Animalia Chordata Mammalia
107656             Bos taurus Animalia Chordata Mammalia
                order            family      genus specificEpithet
413245 Microbiotheria Microbiotheriidae Dromiciops       gliroides
250955      Carnivora           Canidae      Canis           lupus
536725   Artiodactyla           Bovidae        Bos          taurus
393015   Artiodactyla          Cervidae       Pudu            puda
564579   Artiodactyla           Bovidae        Bos          taurus
591758      Carnivora           Canidae  Lycalopex        culpaeus
534315 Perissodactyla           Equidae      Equus        caballus
375249   Artiodactyla           Bovidae        Bos          taurus
506322   Artiodactyla           Bovidae        Bos          taurus
107656   Artiodactyla           Bovidae        Bos          taurus
       infraspecificEpithet  taxonRank verbatimTaxonRank
413245                         especie                sp
250955           familiaris subespecie             subsp
536725                         especie                sp
393015                         especie                sp
564579                         especie                sp
591758                         especie                sp
534315                         especie                sp
375249                         especie                sp
506322                         especie                sp
107656                         especie                sp
       scientificNameAuthorship   vernacularName taxonomicStatus
413245             Thomas, 1894 Monito del monte        aceptado
250955           Linnaeus, 1758  Perro doméstico        aceptado
536725           Linnaeus, 1758             Vaca        aceptado
393015           (Molina, 1782)             Pudú        aceptado
564579           Linnaeus, 1758             Vaca        aceptado
591758           (Molina, 1782)     Zorro culpeo        aceptado
534315           Linnaeus, 1758          Caballo        aceptado
375249           Linnaeus, 1758             Vaca        aceptado
506322           Linnaeus, 1758             Vaca        aceptado
107656           Linnaeus, 1758             Vaca        aceptado
                        geometry
413245 POINT (-8027223 -5030894)
250955 POINT (-7902468 -7009220)
536725 POINT (-8018518 -5909902)
393015 POINT (-8242496 -5181454)
564579 POINT (-8064720 -5776430)
591758 POINT (-7846269 -3992957)
534315 POINT (-7992832 -5895729)
375249 POINT (-7973042 -4627509)
506322 POINT (-7967653 -4639817)
107656 POINT (-7841380 -4072972)</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>comunas</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Simple feature collection with 6 features and 11 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -8133264 ymin: -4748322 xmax: -7828105 ymax: -4017907
Projected CRS: WGS 84 / Pseudo-Mercator
  objectid shape_leng dis_elec cir_sena cod_comuna codregion
1       48  170038.62       16        8       6204         6
2       29  125730.10       15        8       6102         6
3       30   63026.08       15        8       6103         6
4       31   89840.90       15        8       6104         6
5       78  122626.49       23       11       9121         9
6       79  279936.00       23       11       9103         9
  st_area_sh st_length_                                   Region
1  968577420  206184.27 Región del Libertador Bernardo O&#39;Higgins
2  415744636  151911.58 Región del Libertador Bernardo O&#39;Higgins
3  144856484   76355.33 Región del Libertador Bernardo O&#39;Higgins
4  325657168  108874.62 Región del Libertador Bernardo O&#39;Higgins
5  699072708  156680.41                   Región de La Araucanía
6 3127304688  360052.12                   Región de La Araucanía
     Comuna     Provincia                       geometry
1 Marchigüe Cardenal Caro MULTIPOLYGON (((-7992819 -4...
2   Codegua     Cachapoal MULTIPOLYGON (((-7831652 -4...
3    Coinco     Cachapoal MULTIPOLYGON (((-7892616 -4...
4  Coltauco     Cachapoal MULTIPOLYGON (((-7906458 -4...
5  Cholchol        Cautín MULTIPOLYGON (((-8121756 -4...
6     Cunco        Cautín MULTIPOLYGON (((-7992287 -4...</code></pre>
</div>
<p>La función st_join permite buscar las correspondencias espaciales entre 2 objetos y añadir las columnas de un objeto en el otro cuando hay correspondencia espacial:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='op'>(</span><span class='va'>A</span><span class='op'>&lt;-</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_join.html'>st_join</a></span><span class='op'>(</span><span class='va'>spat_occuFotoTrampeo</span>,<span class='va'>comunas</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Simple feature collection with 50 features and 66 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -8787969 ymin: -7022447 xmax: -7830540 ymax: -3985424
Projected CRS: WGS 84 / Pseudo-Mercator
First 10 features:
                                              id        type
413245   CONAF:Fotomonitoreo:PNVPR:2022:AN45:632 Fototrampeo
250955 CONAF:Fotomonitoreo:RNMAG:2022:CP18:16187 Fototrampeo
536725   CONAF:Fotomonitoreo:PNP:2019:BB28:10814 Fototrampeo
393015    CONAF:Fotomonitoreo:PNCH:2021:M01:8073 Fototrampeo
564579   CONAF:Fotomonitoreo:PNCC:2022:H23:11493 Fototrampeo
591758     CONAF:Fotomonitoreo:PNRCL:2018:B7:395 Fototrampeo
534315   CONAF:Fotomonitoreo:PNP:2019:BT19:25590 Fototrampeo
375249     CONAF:Fotomonitoreo:RNM:2021:F07:3241 Fototrampeo
506322    CONAF:Fotomonitoreo:RNM:2021:O26:11251 Fototrampeo
107656    CONAF:Fotomonitoreo:RNRC:2017:I08:1332 Fototrampeo
         modified language
413245 2023-12-06       es
250955 2023-12-06       es
536725 2023-12-06       es
393015 2023-12-06       es
564579 2023-12-06       es
591758 2023-12-06       es
534315 2023-12-06       es
375249 2023-12-06       es
506322 2023-12-06       es
107656 2023-12-06       es
                                                        license
413245 https://creativecommons.org/licenses/by-nc/4.0/legalcode
250955 https://creativecommons.org/licenses/by-nc/4.0/legalcode
536725 https://creativecommons.org/licenses/by-nc/4.0/legalcode
393015 https://creativecommons.org/licenses/by-nc/4.0/legalcode
564579 https://creativecommons.org/licenses/by-nc/4.0/legalcode
591758 https://creativecommons.org/licenses/by-nc/4.0/legalcode
534315 https://creativecommons.org/licenses/by-nc/4.0/legalcode
375249 https://creativecommons.org/licenses/by-nc/4.0/legalcode
506322 https://creativecommons.org/licenses/by-nc/4.0/legalcode
107656 https://creativecommons.org/licenses/by-nc/4.0/legalcode
                                                rightsHolder
413245                 Corporación Nacional Forestal (CONAF)
250955 Centro de Ecología Aplicada y Sustentabilidad (CAPES)
536725                 Corporación Nacional Forestal (CONAF)
393015                 Corporación Nacional Forestal (CONAF)
564579                 Corporación Nacional Forestal (CONAF)
591758                 Corporación Nacional Forestal (CONAF)
534315                 Corporación Nacional Forestal (CONAF)
375249                 Corporación Nacional Forestal (CONAF)
506322                 Corporación Nacional Forestal (CONAF)
107656                 Corporación Nacional Forestal (CONAF)
                                                                                                                                                                                                                                    bibliographicCitation
413245 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
250955 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
536725 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
393015 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
564579 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
591758 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
534315 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
375249 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
506322 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
107656 Corporación Nacional Forestal (CONAF). 2021.Fotomonitoreo de bojetos de conservación y amenazas en el Sistema Nacional de Áreas Silvestres Protegias del Estado (SNASPE). Sitio web: [www.fotomonitoreo.cl]. Corporación Nacional Forestal. Chile.
       institutionID        collectionID
413245         CONAF CONAF:Fotomonitoreo
250955         CONAF CONAF:Fotomonitoreo
536725         CONAF CONAF:Fotomonitoreo
393015         CONAF CONAF:Fotomonitoreo
564579         CONAF CONAF:Fotomonitoreo
591758         CONAF CONAF:Fotomonitoreo
534315         CONAF CONAF:Fotomonitoreo
375249         CONAF CONAF:Fotomonitoreo
506322         CONAF CONAF:Fotomonitoreo
107656         CONAF CONAF:Fotomonitoreo
                             institutionCode collectionCode
413245 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
250955 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
536725 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
393015 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
564579 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
591758 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
534315 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
375249 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
506322 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
107656 Corporación Nacional Forestal (CONAF)  Fotomonitoreo
       ownerInstitutionCode      basisOfRecord
413245                CONAF MachineObservation
250955                CONAF MachineObservation
536725                CONAF MachineObservation
393015                CONAF MachineObservation
564579                CONAF MachineObservation
591758                CONAF MachineObservation
534315                CONAF MachineObservation
375249                CONAF MachineObservation
506322                CONAF MachineObservation
107656                CONAF MachineObservation
                                    occurrenceID individualCount
413245   CONAF:Fotomonitoreo:PNVPR:2022:AN45:632               1
250955 CONAF:Fotomonitoreo:RNMAG:2022:CP18:16187               1
536725   CONAF:Fotomonitoreo:PNP:2019:BB28:10814               4
393015    CONAF:Fotomonitoreo:PNCH:2021:M01:8073               1
564579   CONAF:Fotomonitoreo:PNCC:2022:H23:11493               2
591758     CONAF:Fotomonitoreo:PNRCL:2018:B7:395               1
534315   CONAF:Fotomonitoreo:PNP:2019:BT19:25590               1
375249     CONAF:Fotomonitoreo:RNM:2021:F07:3241               1
506322    CONAF:Fotomonitoreo:RNM:2021:O26:11251               1
107656    CONAF:Fotomonitoreo:RNRC:2017:I08:1332               1
                 sex     lifeStage reproductiveCondition
413245 Indeterminado Indeterminado         Indeterminado
250955 Indeterminado Indeterminado         Indeterminado
536725 Indeterminado Indeterminado         Indeterminado
393015 Indeterminado Indeterminado         Indeterminado
564579 Indeterminado Indeterminado         Indeterminado
591758 Indeterminado Indeterminado         Indeterminado
534315 Indeterminado Indeterminado         Indeterminado
375249 Indeterminado Indeterminado         Indeterminado
506322 Indeterminado Indeterminado         Indeterminado
107656 Indeterminado Indeterminado         Indeterminado
       establishmentMeans degreeOfEstablishment occurrenceStatus
413245             native                native          present
250955         introduced    widespreadInvasive          present
536725         introduced    widespreadInvasive          present
393015             native                native          present
564579         introduced    widespreadInvasive          present
591758             native                native          present
534315         introduced    widespreadInvasive          present
375249         introduced    widespreadInvasive          present
506322         introduced    widespreadInvasive          present
107656         introduced    widespreadInvasive          present
       occurrenceRemarks                             eventID
413245                   CONAF:Fotomonitoreo:PNVPR:2022:AN45
250955                   CONAF:Fotomonitoreo:RNMAG:2022:CP18
536725                     CONAF:Fotomonitoreo:PNP:2019:BB28
393015                     CONAF:Fotomonitoreo:PNCH:2021:M01
564579                     CONAF:Fotomonitoreo:PNCC:2022:H23
591758                     CONAF:Fotomonitoreo:PNRCL:2018:B7
534315                     CONAF:Fotomonitoreo:PNP:2019:BT19
375249                      CONAF:Fotomonitoreo:RNM:2021:F07
506322                      CONAF:Fotomonitoreo:RNM:2021:O26
107656                     CONAF:Fotomonitoreo:RNRC:2017:I08
        eventDate   eventTime startDayOfYear endDayOfYear year month
413245 2022-01-21 22:01:34-04            300           33 2022     1
250955 2022-03-28 04:53:28-04             85          319 2022     3
536725 2019-02-27 21:05:07-04             39          143 2019     2
393015 2021-03-27 12:38:05-04             62           96 2021     3
564579 2022-01-19 06:59:16-04             12           43 2022     1
591758 2018-05-02 04:28:57-04            114          144 2018     5
534315 2019-07-27 23:55:51-04             37          225 2019     7
375249 2020-12-18 19:55:36-04            346           11 2020    12
506322 2021-02-17 08:56:02-04             36           68 2021     2
107656 2017-08-12 16:22:16-04            144          265 2017     8
       day locationID     continent country countryCode
413245  21      PNVPR South America   Chile          CL
250955  28      RNMAG South America   Chile          CL
536725  27        PNP South America   Chile          CL
393015  27       PNCH South America   Chile          CL
564579  19       PNCC South America   Chile          CL
591758   2      PNRCL South America   Chile          CL
534315  27        PNP South America   Chile          CL
375249  18        RNM South America   Chile          CL
506322  17        RNM South America   Chile          CL
107656  12       RNRC South America   Chile          CL
                                             stateProvince
413245                                 Región de Los Lagos
250955      Región de Magallanes y de la Antártica Chilena
536725 Región de Aysén del General Carlos Ibáñez del Campo
393015                                 Región de Los Lagos
564579 Región de Aysén del General Carlos Ibáñez del Campo
591758                    Región Metropolitana de Santiago
534315 Región de Aysén del General Carlos Ibáñez del Campo
375249                              Región de La Araucanía
506322                              Región de La Araucanía
107656    Región del Libertador General Bernardo O&#39;Higgins
                                    locality geodeticDatum
413245 Parque Nacional Vicente Pérez Rosales     EPSG:4326
250955           Reserva Nacional Magallanes     EPSG:4326
536725             Parque Nacional Patagonia     EPSG:4326
393015                Parque Nacional Chiloé     EPSG:4326
564579        Parque Nacional Cerro Castillo     EPSG:4326
591758          Parque Nacional Rio Clarillo     EPSG:4326
534315             Parque Nacional Patagonia     EPSG:4326
375249        Reserva Nacional Malalcahuello     EPSG:4326
506322        Reserva Nacional Malalcahuello     EPSG:4326
107656  Reserva Nacional Rio de los Cipreses     EPSG:4326
       coordinateUncertaintyInMeters verbatimCoordinateSystem
413245                          1000          decimal degrees
250955                          1000          decimal degrees
536725                          1000          decimal degrees
393015                          1000          decimal degrees
564579                          1000          decimal degrees
591758                          1000          decimal degrees
534315                          1000          decimal degrees
375249                          1000          decimal degrees
506322                          1000          decimal degrees
107656                          1000          decimal degrees
       verbatimSRS                        scientificName
413245      WGS 84     Dromiciops gliroides Thomas, 1894
250955      WGS 84 Canis lupus familiaris Linnaeus, 1758
536725      WGS 84             Bos taurus Linnaeus, 1758
393015      WGS 84              Pudu puda (Molina, 1782)
564579      WGS 84             Bos taurus Linnaeus, 1758
591758      WGS 84     Lycalopex culpaeus (Molina, 1782)
534315      WGS 84         Equus caballus Linnaeus, 1758
375249      WGS 84             Bos taurus Linnaeus, 1758
506322      WGS 84             Bos taurus Linnaeus, 1758
107656      WGS 84             Bos taurus Linnaeus, 1758
            originalNameUsage  kingdom   phylum    class
413245   Dromiciops gliroides Animalia Chordata Mammalia
250955 Canis lupus familiaris Animalia Chordata Mammalia
536725             Bos taurus Animalia Chordata Mammalia
393015              Pudu puda Animalia Chordata Mammalia
564579             Bos taurus Animalia Chordata Mammalia
591758     Lycalopex culpaeus Animalia Chordata Mammalia
534315         Equus caballus Animalia Chordata Mammalia
375249             Bos taurus Animalia Chordata Mammalia
506322             Bos taurus Animalia Chordata Mammalia
107656             Bos taurus Animalia Chordata Mammalia
                order            family      genus specificEpithet
413245 Microbiotheria Microbiotheriidae Dromiciops       gliroides
250955      Carnivora           Canidae      Canis           lupus
536725   Artiodactyla           Bovidae        Bos          taurus
393015   Artiodactyla          Cervidae       Pudu            puda
564579   Artiodactyla           Bovidae        Bos          taurus
591758      Carnivora           Canidae  Lycalopex        culpaeus
534315 Perissodactyla           Equidae      Equus        caballus
375249   Artiodactyla           Bovidae        Bos          taurus
506322   Artiodactyla           Bovidae        Bos          taurus
107656   Artiodactyla           Bovidae        Bos          taurus
       infraspecificEpithet  taxonRank verbatimTaxonRank
413245                         especie                sp
250955           familiaris subespecie             subsp
536725                         especie                sp
393015                         especie                sp
564579                         especie                sp
591758                         especie                sp
534315                         especie                sp
375249                         especie                sp
506322                         especie                sp
107656                         especie                sp
       scientificNameAuthorship   vernacularName taxonomicStatus
413245             Thomas, 1894 Monito del monte        aceptado
250955           Linnaeus, 1758  Perro doméstico        aceptado
536725           Linnaeus, 1758             Vaca        aceptado
393015           (Molina, 1782)             Pudú        aceptado
564579           Linnaeus, 1758             Vaca        aceptado
591758           (Molina, 1782)     Zorro culpeo        aceptado
534315           Linnaeus, 1758          Caballo        aceptado
375249           Linnaeus, 1758             Vaca        aceptado
506322           Linnaeus, 1758             Vaca        aceptado
107656           Linnaeus, 1758             Vaca        aceptado
       objectid shape_leng dis_elec cir_sena cod_comuna codregion
413245      126   528520.5       25       13      10109        10
250955    17170 11496900.1       28       15      12101        12
536725      393  1181428.8       27       14      11401        11
393015      342   596835.8       26       13      10202        10
564579    10993  1340686.3       27       14      11101        11
591758      291   103841.8       12        7      13202        13
534315      393  1181428.8       27       14      11401        11
375249      100   213490.6       22       11       9203         9
506322      100   213490.6       22       11       9203         9
107656       36   287697.2       15        8       6108         6
        st_area_sh st_length_
413245  7134920316   721040.8
250955 50581102823 18253815.6
536725 12186491014   699724.7
393015  3214864281   669712.7
564579 14826238838  1053280.0
591758   644688716   125049.2
534315 12186491014   699724.7
375249  2705069734   272634.1
506322  2705069734   272634.1
107656  3814100960   348068.3
                                          Region       Comuna
413245                       Región de Los Lagos Puerto Varas
250955  Región de Magallanes y Antártica Chilena Punta Arenas
536725 Región de Aysén del Gral.Ibañez del Campo  Chile Chico
393015                       Región de Los Lagos        Ancud
564579 Región de Aysén del Gral.Ibañez del Campo    Coyhaique
591758          Región Metropolitana de Santiago       Pirque
534315 Región de Aysén del Gral.Ibañez del Campo  Chile Chico
375249                    Región de La Araucanía   Curacautín
506322                    Región de La Araucanía   Curacautín
107656  Región del Libertador Bernardo O&#39;Higgins      Machalí
             Provincia                  geometry
413245      Llanquihue POINT (-8027223 -5030894)
250955      Magallanes POINT (-7902468 -7009220)
536725 General Carrera POINT (-8018518 -5909902)
393015          Chiloe POINT (-8242496 -5181454)
564579       Coyhaique POINT (-8064720 -5776430)
591758      Cordillera POINT (-7846269 -3992957)
534315 General Carrera POINT (-7992832 -5895729)
375249         Malleco POINT (-7973042 -4627509)
506322         Malleco POINT (-7967653 -4639817)
107656       Cachapoal POINT (-7841380 -4072972)</code></pre>
</div>
<h2 data-number="2.7" id="bonus-mapas-en-r"><span class="header-section-number">2.7</span> Bonus: mapas en R</h2>
<p>En R se pueden hacer mapas utilizando la función <code>plot</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>st_geometry</span><span class='op'>(</span><span class='va'>spat_occuFotoTrampeo</span><span class='op'>)</span>,type<span class='op'>=</span><span class='st'>"n"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>st_geometry</span><span class='op'>(</span><span class='va'>comunas</span><span class='op'>)</span>,add<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>spat_occuFotoTrampeo</span>,col<span class='op'>=</span><span class='st'>"red"</span>,add<span class='op'>=</span><span class='cn'>T</span>,pch<span class='op'>=</span><span class='st'>'+'</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="prop_act6_espacial_files/figure-html5/unnamed-chunk-13-1.png" width="288" /></p>
</div>
<p>Anotar: siendo honesto, hacer mapas en R toma mucho tiempo… Sin embargo, para los casos que necesitan automatizar la producción de muchos mapas, puede ser una solución viable.</p>
<h1 data-number="3" id="ejercicio-3-crear-una-base-de-datos-espacial-para-determinar-los-habitats-de-muestreo"><span class="header-section-number">3</span> Ejercicio 3: crear una base de datos espacial para determinar los habitats de muestreo</h1>
<h2 data-number="3.1" id="con-spatialite"><span class="header-section-number">3.1</span> Con spatialite</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rsqlite.r-dbi.org'>RSQLite</a></span><span class='op'>)</span></span>
<span><span class='va'>esca_event</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"../Datos/esca_event.csv"</span><span class='op'>)</span></span>
<span><span class='va'>spat_esca_event</span><span class='op'>&lt;-</span><span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>esca_event</span>,coords<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x_srid3116"</span>,<span class='st'>"y_srid3116"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>spat_esca_event</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='st'>"EPSG:3116"</span></span>
<span><span class='va'>landcov</span><span class='op'>&lt;-</span><span class='fu'>st_read</span><span class='op'>(</span>dsn <span class='op'>=</span> <span class='st'>"../Datos/esca_landcov/"</span>,layer<span class='op'>=</span><span class='st'>"landcov"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Reading layer `landcov&#39; from data source 
  `/home/marius/Travail/Enseignement/2023_cursoBiodiversidadChile/2024/Datos/esca_landcov&#39; 
  using driver `ESRI Shapefile&#39;
Simple feature collection with 10384 features and 2 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 1004350 ymin: 1272718 xmax: 1046180 ymax: 1342900
Projected CRS: MAGNA-SIRGAS / Colombia Bogota zone</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>st_write</span><span class='op'>(</span><span class='va'>spat_esca_event</span>,dsn<span class='op'>=</span><span class='st'>"../Resultados/spat_esca.sqlite"</span>,layer<span class='op'>=</span><span class='st'>"spat_esca_event"</span>,delete_layer <span class='op'>=</span> <span class='cn'>T</span>,driver<span class='op'>=</span><span class='st'>"SQLite"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Deleting layer `spat_esca_event&#39; using driver `SQLite&#39;
Writing layer `spat_esca_event&#39; to data source 
  `../Resultados/spat_esca.sqlite&#39; using driver `SQLite&#39;
Writing 878 features with 3 fields and geometry type Point.</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>st_write</span><span class='op'>(</span><span class='va'>landcov</span>,dsn<span class='op'>=</span><span class='st'>"../Resultados/spat_esca.sqlite"</span>,layer<span class='op'>=</span><span class='st'>"landcov"</span>,delete_layer <span class='op'>=</span><span class='cn'>T</span>,driver<span class='op'>=</span><span class='st'>"SQLite"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Deleting layer `landcov&#39; using driver `SQLite&#39;
Writing layer `landcov&#39; to data source 
  `../Resultados/spat_esca.sqlite&#39; using driver `SQLite&#39;
Writing 10384 features with 2 fields and geometry type Polygon.</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>spat_esca</span><span class='op'>&lt;-</span><span class='fu'>dbConnect</span><span class='op'>(</span><span class='fu'><a href='https://rsqlite.r-dbi.org/reference/SQLite.html'>SQLite</a></span><span class='op'>(</span><span class='op'>)</span>,dbname<span class='op'>=</span><span class='st'>"../Resultados/spat_esca.sqlite"</span><span class='op'>)</span></span>
<span><span class='fu'>dbSendStatement</span><span class='op'>(</span><span class='va'>spat_esca</span>, <span class='st'>"SELECT load_extension('mod_spatialite')"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>&lt;SQLiteResult&gt;
  SQL  SELECT load_extension(&#39;mod_spatialite&#39;)
  ROWS Fetched: 0 [incomplete]
       Changed: 0</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>dbListFields</span><span class='op'>(</span><span class='va'>spat_esca</span>,<span class='st'>"landcov"</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] &quot;ogc_fid&quot;    &quot;cd_landcov&quot; &quot;landcov&quot;    &quot;GEOMETRY&quot;  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>area_hab</span><span class='op'>&lt;-</span><span class='fu'>dbGetQuery</span><span class='op'>(</span><span class='va'>spat_esca</span>,</span>
<span><span class='st'>"SELECT landcov,SUM(ST_Area(geometry)) superf</span></span>
<span><span class='st'>FROM landcov</span></span>
<span><span class='st'>GROUP BY landcov</span></span>
<span><span class='st'>"</span><span class='op'>)</span></span>
<span><span class='op'>(</span><span class='fu'>dbGetQuery</span><span class='op'>(</span><span class='va'>spat_esca</span>,</span>
<span><span class='st'>"SELECT cd_event, protocol, landcov</span></span>
<span><span class='st'>FROM spat_esca_event e</span></span>
<span><span class='st'>LEFT JOIN landcov l ON ST_Intersects(e.geometry,l.geometry)</span></span>
<span><span class='st'>LIMIT 10</span></span>
<span><span class='st'>"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>   cd_event                      protocol        landcov
1      3247 Trampa de excrementos humanos Bosque Ripario
2      3780    Captura manual de insectos Bosque Ripario
3      3249    Captura manual de insectos Bosque Ripario
4      3250    Captura manual de insectos Bosque Ripario
5      3242 Trampa de excrementos humanos Bosque Ripario
6      3243 Trampa de excrementos humanos          Palma
7      3244 Trampa de excrementos humanos Bosque Ripario
8      3778    Captura manual de insectos Bosque Ripario
9      3009    Captura manual de insectos Bosque Ripario
10     3010    Captura manual de insectos Bosque Ripario</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>nbEvent_hab</span><span class='op'>&lt;-</span><span class='fu'>dbGetQuery</span><span class='op'>(</span><span class='va'>spat_esca</span>,</span>
<span><span class='st'>"SELECT landcov,</span></span>
<span><span class='st'>  COUNT(DISTINCT cd_event) FILTER (WHERE protocol='Captura manual de insectos') num_event_cm,</span></span>
<span><span class='st'>  COUNT(DISTINCT cd_event) FILTER (WHERE protocol='Trampa de excrementos humanos') num_event_teh</span></span>
<span><span class='st'>FROM spat_esca_event e</span></span>
<span><span class='st'>RIGHT JOIN landcov l ON ST_Intersects(e.geometry,l.geometry)</span></span>
<span><span class='st'>GROUP BY landcov;</span></span>
<span><span class='st'>"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>nbEvent_hab</span><span class='op'>&lt;-</span><span class='va'>nbEvent_hab</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>nbEvent_hab</span><span class='op'>$</span><span class='va'>landcov</span>,<span class='va'>area_hab</span><span class='op'>$</span><span class='va'>landcov</span><span class='op'>)</span>,<span class='op'>]</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>,mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='fl'>5</span>,<span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='va'>area_hab</span><span class='op'>$</span><span class='va'>superf</span>,names.arg <span class='op'>=</span> <span class='va'>area_hab</span><span class='op'>$</span><span class='va'>landcov</span>,las<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>nbEvent_hab</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"num_event_cm"</span>,<span class='st'>"num_event_teh"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>,names.arg <span class='op'>=</span> <span class='va'>nbEvent_hab</span><span class='op'>$</span><span class='va'>landcov</span>,beside <span class='op'>=</span> <span class='cn'>T</span>,las<span class='op'>=</span><span class='fl'>2</span>,legend<span class='op'>=</span><span class='cn'>T</span>,legend.text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Captura"</span>,<span class='st'>"trampa"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="prop_act6_espacial_files/figure-html5/unnamed-chunk-15-1.png" width="960" /></p>
</div>
<h2 data-number="3.2" id="con-postgis"><span class="header-section-number">3.2</span> Con Postgis</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
